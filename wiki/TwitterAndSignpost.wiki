#summary Real-life example of how to use Signpost with Twitter
#labels twitter,Featured,example

= NOTE =
*Until Signpost implements the changes made to the OAuth specification (which are still not finalized), it may not work as expected in conjunction with Twitter and Fire Eagle. I'm working on it.*

= Using Signpost with Twitter =
You can get a consumer key and secret for your Twitter application [http://twitter.com/oauth_clients here].

= Example Code =
{{{
public class Main {

    public static void main(String[] args) throws Exception {

        OAuthConsumer consumer = new DefaultOAuthConsumer(
                // the consumer key of this app (replace this with yours)
                "iIlNngv1KdV6XzNYkoLA",
                // the consumer secret of this app (replace this with yours)
                "exQ94pBpLXFcyttvLoxU2nrktThrlsj580zjYzmoM",
                SignatureMethod.HMAC_SHA1);

        OAuthProvider provider = new DefaultOAuthProvider(consumer,
                "http://twitter.com/oauth/request_token",
                "http://twitter.com/oauth/access_token",
                "http://twitter.com/oauth/authorize");

        // we do not support callbacks, thus pass null
        String authUrl = provider.retrieveRequestToken(null);

        // bring the user to authUrl, e.g. open a web browser
        // ...         

        // user must have granted authorization at this point
        provider.retrieveAccessToken();

        // store consumer.getToken() and consumer.getTokenSecret()
        // ...

        // create a request that requires authentication
        URL url = new URL("http://twitter.com/statuses/mentions.xml");
        HttpURLConnection request = (HttpURLConnection) url.openConnection();

        // sign the request
        consumer.sign(request);

        // send the request
        request.connect();

        // response status should be 200 OK
        int statusCode = request.getResponseCode();
    }
}
}}}

Here is what you typically do step by step:

  # When your users want to access Twitter through your application for the first time, you should display some kind of notification which indicates that an authentication process is about to start
  # Call OAuthProvider.retrieveRequestToken() on the OAuthProvider
  # On method return, you have to send the user to the URL returned by it. The user now must grant your application access to Twitter - this step is out of the reach of your application, because it happens in the Web browser. However, if your application can receive callbacks via URLs, you can be informed about successful authorization by providing a callback URL to retrieveRequestToken().
  # Call OAuthProvider.retrieveAccessToken()
  # On method return, call OAuthConsumer.getToken() and OAuthConsumer.getTokenSecret(), associate them with the user who triggered the authorization procedure, and store them away safely.
  # Any OAuthConsumer configured with these values can now sign HTTP requests in order to access protected resources on Twitter on behalf of that user.

You can also [http://oauth-signpost.googlecode.com/files/OAuthTwitterExample.zip download this example code] as a Java/Eclipse project and go from there. This example application executes all steps above sequentially in the console. If run successfully, its output should be something like this:

<pre>
Fetching request token from Twitter...
Request token: g1re4iYfknOYMB62JZkddjwhCfvfn4WPdZrzgscMOA
Token secret: wKStK0dmhPcuFxBki3imJv7yVNXgRndmW4LSmuCg
Now visit:
http://twitter.com/oauth/authorize?oauth_token=g1re4iYfknOYMB62JZkddjwhCfvfn4WPdZrzgscMOA&oauth_callback=
... and grant this app authorization
Hit ENTER when you're done

Fetching access token from Twitter...
Access token: 14418463-Xt70aZ8b2jz19MzY7JnQJ6HglPh0Hc5p939gLH5YI
Token secret: TkG689FOx7amgdX2ta6epE5MYsmZxVuO9ith7FtJrs
Sending request to Twitter...
Response: 200 OK
</pre>